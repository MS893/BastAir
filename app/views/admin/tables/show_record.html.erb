<div class="container mt-4">
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h1>Détail de l'enregistrement #<%= @record.id %></h1>
    <div>
      <div class="d-flex gap-2">
        <%# Pour les actions qui modifient des données (POST, PATCH, DELETE) %>
        <%# La confirmation est gérée par un `onsubmit` JavaScript directement sur le formulaire. %>
        <% if @table_name == 'transactions' && current_user.tresorier? %>
          <% if @record.discarded? %>
            <%= button_to 'Restaurer', admin_restore_table_record_path(table_name: @table_name, id: @record.id), method: :patch, class: 'btn btn-success', data: { turbo: false }, form: { onsubmit: "return confirm('Êtes-vous sûr de vouloir restaurer cette transaction ?');" } %>
            <%= button_to 'Supprimer Définitivement', admin_table_record_path(table_name: @table_name, id: @record.id, force: true), method: :delete, class: 'btn btn-danger', data: { turbo: false }, form: { onsubmit: "return confirm('ATTENTION : Cette action est irréversible. Continuer ?');" } %>
          <% else %>
            <%= link_to 'Modifier', admin_edit_table_record_path(table_name: @table_name, id: @record.id), class: 'btn btn-primary', data: { turbo: false } %>
            <%= button_to 'Mettre à la corbeille', admin_table_record_path(table_name: @table_name, id: @record.id), method: :delete, class: 'btn btn-warning', data: { turbo: false }, form: { onsubmit: "return confirm('Êtes-vous sûr de vouloir mettre cette transaction à la corbeille ?');" } %>
          <% end %>
        <% elsif @table_name != 'transactions' %>
          <%= link_to 'Modifier', admin_edit_table_record_path(table_name: @table_name, id: @record.id), class: 'btn btn-primary', data: { turbo: false } %>
          <%= button_to 'Supprimer', admin_table_record_path(table_name: @table_name, id: @record.id), method: :delete, class: 'btn btn-danger', data: { turbo: false }, form: { onsubmit: "return confirm('Êtes-vous sûr de vouloir supprimer cet enregistrement ?');" } %>
        <% end %>
        <%= link_to 'Retour à la liste', admin_tables_path(table_name: @table_name), class: 'btn btn-secondary', data: { turbo: false } %>
      </div>
    </div>
  </div>

  <div class="card">
    <div class="card-body">
      <%# On utilise une structure de divs au lieu de <dl> pour un contrôle parfait de l'alignement vertical %>
      <div class="record-attributes">
        <% attributes = @record.attributes %>
        <% attributes.each_with_index do |(attr_name, _attr_value), index| %>
          <div class="row <%= 'border-bottom' unless index == attributes.size - 1 %>">
            <div class="col-sm-3 fw-bold py-2"><%= attr_name.humanize %></div>
            <div class="col-sm-9 py-2">
            <%= display_record_attribute(@record, attr_name, @associated_records) %>
            </div>
          </div>
        <% end %>
      </div>
    </div>
  </div>
</div>
