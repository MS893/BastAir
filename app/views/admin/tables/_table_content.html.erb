<h5>Contenu de la table : <%= translate_table_name(table_name) %> (<%= table_name %>)</h5>

<%= form_with(url: admin_tables_path, method: :get, data: { turbo_frame: "table_content_frame", turbo_action: "advance" }) do |form| %>
  <%= form.hidden_field :table_name, value: table_name %>
  <div class="input-group my-3">
    <%= form.search_field :query, value: params[:query], class: 'form-control', placeholder: 'Rechercher dans cette table...', 'aria-label': 'Rechercher' %>
    <div class="input-group-append">
      <%= form.submit 'Rechercher', class: 'btn btn-outline-primary ms-3' %>
    </div>
  </div>
<% end %>

<% if records.empty? %>
  <div class="alert alert-warning">Cette table est vide.</div>
<% else %>
  <div class="table-responsive">
    <table class="table table-striped table-bordered">
      <thead class="thead-dark">
        <tr>
          <% visible_columns = records.first.attributes.keys - hidden_columns_for(table_name) %>
          <% visible_columns.each do |col| %>
            <th><%= sortable_header(col, table_name, params) %></th>
          <% end %>
        </tr>
      </thead>
      <tbody>
        <% records.each do |record| %>
          <tr data-controller="clickable-row" data-clickable-row-url-value="<%= admin_show_table_record_path(table_name: table_name, id: record.id) %>" style="cursor: pointer;">
            <% visible_columns.each do |col| %>
              <td><%= display_cell_content(record, col, table_name) %></td>
            <% end %>
          </tr>
        <% end %>
      </tbody>
    </table>
  </div>

  <div data-turbo-prefetch="false">
    <%= paginate records %>
  </div>

<% end %>
